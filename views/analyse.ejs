<%- include("partials/header.ejs"); -%>

<h1>Graphical Analysis</h1>

<!-- </div> -->
<script>
    var yearArr = [];
    var nameArr = [];
    var feeArr = [];
    <% for(var i=0; i < markDetail.length; i++){ %>
        yearArr.push(<%= markDetail[i].years %> );
        nameArr.push('<%= markDetail[i].fullname %>' + ' (<%= markDetail[i].courseTaught %>)');
        feeArr.push(<%= markDetail[i].fees %>);
    <% } %>
</script>

<div id='myDiv' style="position: absolute; right:80px;">
    <script>
        var data = [{
            values: yearArr,
            labels: nameArr,
            type: 'pie'
        }];

        var layout = {
            height: 400,
            width: 500
        };

        Plotly.newPlot('myDiv', data, layout);
            
    </script>
</div>

    <div id='myDiv2'>
        <script>
            var data = [
            {
                x: nameArr,
                y: feeArr,
                type: 'bar'
            }
            ];

            var layout = {
                barmode : 'stack',
                height: 400,
                width: 700
            };

            Plotly.newPlot('myDiv2', data, layout);
        </script>
    </div>

    <!-- <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d15062.175825256429!2d72.86336325!3d19.30218845!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2sin!4v1693838214722!5m2!1sen!2sin" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe> -->

    <style>
        /* Set a fixed height for the map container */
        #map {
            width: 1150px;
            height: 400px;
        }
    </style>


    <div id="map"></div>

    <!-- Include Leaflet.js -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

    <script>
        
        // Initialize the map
        var map = L.map('map').setView([19.1485, 77.3191], 5.5);

        // Add a tile layer (OpenStreetMap)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
        }).addTo(map);
        <% for(var i=0; i < markDetail.length; i++){ %>
            // Add a marker
            // var marker = L.marker([19.0760, 72.8777]).addTo(map);
            var marker = L.marker([<%= markDetail[i].lat%>, <%= markDetail[i].lon %>]).addTo(map);

            // Add a popup to the marker
            marker.bindPopup('<%= markDetail[i].fullname %>' + ' (<%= markDetail[i].courseTaught %>)').openPopup();
        <% } %>
    </script>



<%- include("partials/footer.ejs"); -%>