<%- include("partials/header.ejs"); -%>

<h1>Graphical Analysis</h1>

<script>
    var yearArr = [];
    var nameArr = [];
    var feeArr = [];
    <% for(var i=0; i < markDetail.length; i++){ %>

        yearArr.push(<%= markDetail[i].years %> );
        nameArr.push('<%= markDetail[i].fullname %>' + ' (<%= markDetail[i].courseTaught %>)');
        feeArr.push(<%= markDetail[i].fees %>);
        
    <% } %>
</script>

<div id='myDiv' style="position: absolute; right:80px;">
    <script>
        var data = [{
            values: yearArr,
            labels: nameArr,
            type: 'pie'
        }];

        var layout = {
            height: 400,
            width: 500
        };

        Plotly.newPlot('myDiv', data, layout);
            
    </script>
</div>

    <div id='myDiv2'>
        <script>
            var data = [
            {
                x: nameArr,
                y: feeArr,
                type: 'bar'
            }
            ];

            var layout = {
                barmode : 'stack',
                height: 400,
                width: 700
            };

            Plotly.newPlot('myDiv2', data, layout);
        </script>
    </div>

    <style>
        #map {
            width: 1150px;
            height: 400px;
        }
    </style>


    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

    <script>
        
        var map = L.map('map').setView([19.1485, 77.3191], 5.5);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
        }).addTo(map);

        <% for(var i=0; i < markDetail.length; i++){ %>

            var marker = L.marker([<%= markDetail[i].lat%>, <%= markDetail[i].lon %>]).addTo(map);
            marker.bindPopup('<%= markDetail[i].fullname %>' + ' (<%= markDetail[i].courseTaught %>)').openPopup();

        <% } %>
    </script>



<!-- <%- include("partials/footer.ejs"); -%> -->
</div>
<div class="footer-padding"></div>
  <div class="footer">
    <p>Copyright Â©2023 Home Tutor Pvt. Ltd. All rights reserved.</p>
  </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<script src="index.js"></script>

<!-- for html2pdf i think -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"crossorigin="anonymous"></script>
<style>
    .footer-padding {
	padding-bottom: 60px;
}

.footer {
	position:relative;
  /* position: fixed; */
	text-align: center;
	bottom: 0;
	width: 100%;
  /* height:auto; */
	height: 40px;
	/* background-color: grey; */
  background-color: #F88379;
}
</style>
</body>
</html>